
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>sync-data, sync-net setup Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../styles/website.css">
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    
    <link rel="prev" href="realtime-setup.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../step-by-step/readme.html">
            
                <a href="../step-by-step/readme.html">
            
                    
                    Step by step intro to basic Feathers >>
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../step-by-step/intro/readme.html">
            
                <a href="../step-by-step/intro/readme.html">
            
                    
                    Introduction >>
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1.1" data-path="../step-by-step/intro/not-worry.html">
            
                <a href="../step-by-step/intro/not-worry.html">
            
                    
                    What not to worry about
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../step-by-step/basic-feathers/readme.html">
            
                <a href="../step-by-step/basic-feathers/readme.html">
            
                    
                    Basic Feathers >>
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.2.1" data-path="../step-by-step/basic-feathers/database-connector.html">
            
                <a href="../step-by-step/basic-feathers/database-connector.html">
            
                    
                    A database connector
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.2" data-path="../step-by-step/basic-feathers/rest-api-server.html">
            
                <a href="../step-by-step/basic-feathers/rest-api-server.html">
            
                    
                    A REST API server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.3" data-path="../step-by-step/basic-feathers/rest-client.html">
            
                <a href="../step-by-step/basic-feathers/rest-client.html">
            
                    
                    A Feathers REST client
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.4" data-path="../step-by-step/basic-feathers/socket-client.html">
            
                <a href="../step-by-step/basic-feathers/socket-client.html">
            
                    
                    A Feathers websocket client
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.5" data-path="../step-by-step/basic-feathers/ah-ha.html">
            
                <a href="../step-by-step/basic-feathers/ah-ha.html">
            
                    
                    The "ah-ha" moment
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.6" data-path="../step-by-step/basic-feathers/hooks-1.html">
            
                <a href="../step-by-step/basic-feathers/hooks-1.html">
            
                    
                    Hooks, part 1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.7" data-path="../step-by-step/basic-feathers/hooks-2.html">
            
                <a href="../step-by-step/basic-feathers/hooks-2.html">
            
                    
                    Hooks, part 2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.8" data-path="../step-by-step/basic-feathers/real-time.html">
            
                <a href="../step-by-step/basic-feathers/real-time.html">
            
                    
                    Real-time
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../step-by-step/generators/readme.html">
            
                <a href="../step-by-step/generators/readme.html">
            
                    
                    Generators >>
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.3.1" data-path="../step-by-step/generators/app.html">
            
                <a href="../step-by-step/generators/app.html">
            
                    
                    Generating an app
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3.2" data-path="../step-by-step/generators/service.html">
            
                <a href="../step-by-step/generators/service.html">
            
                    
                    Adding a service
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../step-by-step/what-next.html">
            
                <a href="../step-by-step/what-next.html">
            
                    
                    What's next?
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../step-by-step/production-ready.html">
            
                <a href="../step-by-step/production-ready.html">
            
                    
                    Is Feathers production ready?
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="../step-by-step/appendix/readme.html">
            
                <a href="../step-by-step/appendix/readme.html">
            
                    
                    Appendix >>
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.6.1" data-path="../step-by-step/appendix/what-is-this.html">
            
                <a href="../step-by-step/appendix/what-is-this.html">
            
                    
                    What is 'this'?
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../chat/readme.html">
            
                <a href="../chat/readme.html">
            
                    
                    Writing a chat room app >>
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../chat/server/readme.html">
            
                <a href="../chat/server/readme.html">
            
                    
                    Server >>
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.1" data-path="../chat/server/start-server.html">
            
                <a href="../chat/server/start-server.html">
            
                    
                    Starting the server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2" data-path="../chat/server/start-front-end.html">
            
                <a href="../chat/server/start-front-end.html">
            
                    
                    Starting the front-end
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.3" data-path="../chat/server/finish-server.html">
            
                <a href="../chat/server/finish-server.html">
            
                    
                    Finishing the server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.4" data-path="../chat/server/user-mgnt.html">
            
                <a href="../chat/server/user-mgnt.html">
            
                    
                    User management
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../chat/client/readme.html">
            
                <a href="../chat/client/readme.html">
            
                    
                    Client >>
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1" data-path="../chat/client/jQuery.html">
            
                <a href="../chat/client/jQuery.html">
            
                    
                    jQuery client
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2" data-path="../chat/client/webpack.html">
            
                <a href="../chat/client/webpack.html">
            
                    
                    Using Webpack
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.3" data-path="../chat/client/oauth.html">
            
                <a href="../chat/client/oauth.html">
            
                    
                    OAuth jQuery client
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.4" data-path="../chat/client/other-clients.html">
            
                <a href="../chat/client/other-clients.html">
            
                    
                    Clients for other frameworks
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../chat/what-next.html">
            
                <a href="../chat/what-next.html">
            
                    
                    What's next?
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../adapters/readme.html">
            
                <a href="../adapters/readme.html">
            
                    
                    Adapters >>
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../adapters/redux-services/readme.html">
            
                <a href="../adapters/redux-services/readme.html">
            
                    
                    Redux for Feathers services >>
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../adapters/redux-auth/readme.html">
            
                <a href="../adapters/redux-auth/readme.html">
            
                    
                    Redux for Feathers authentication >>
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="readme.html">
            
                <a href="readme.html">
            
                    
                    Offline
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="strategies.html">
            
                <a href="strategies.html">
            
                    
                    Strategies
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="snapshot.html">
            
                <a href="snapshot.html">
            
                    
                    snapshot
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="realtime.html">
            
                <a href="realtime.html">
            
                    
                    realtime
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="owndata-ownnet.html">
            
                <a href="owndata-ownnet.html">
            
                    
                    own-data & own-net
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="syncdata-syncnet.html">
            
                <a href="syncdata-syncnet.html">
            
                    
                    sync-data & sync-net
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6" data-path="database-records.html">
            
                <a href="database-records.html">
            
                    
                    Database records
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.7" data-path="publications.html">
            
                <a href="publications.html">
            
                    
                    Publications
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.8" data-path="filtering.html">
            
                <a href="filtering.html">
            
                    
                    Filtering service events
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.9" data-path="browsers-mobile-devices.html">
            
                <a href="browsers-mobile-devices.html">
            
                    
                    Browsers & mobile devices
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.10" data-path="snapshot-setup.html">
            
                <a href="snapshot-setup.html">
            
                    
                    snapshot setup
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.11" data-path="realtime-setup.html">
            
                <a href="realtime-setup.html">
            
                    
                    realtime setup
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.5.12" data-path="sync-setup.html">
            
                <a href="sync-setup.html">
            
                    
                    sync-data, sync-net setup
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >sync-data, sync-net setup</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="sync-data-sync-net-setup">Sync-data, sync-net setup</h1>
<p>| <strong>Let&apos;s show the code needed for the sync-data and sync-net strategies.</strong></p>
<p>Both sync strategies start with a snapshot of the remote database data.
Subsequent data changes made at the remote are duplicated on the client as they occur in near real time.
Data changes made on the client are likewise duplicated on the remote service.
The data changes are applied in the same order as they occurred.</p>
<p>Mutations of the client data can continue while disconnected.
Since the remote service cannot be updated immediately,
information is retained in persisted storage to await a reconnection.
The specifics of the information retained
<a href="syncdata-syncnet.html">differs</a>
between sync-data and sync-net.</p>
<p>The server processes this information on reconnection.
A user provided conflict resolver is called when a replication conflict is detected.
This resolver determines what the record should contain.</p>
<p>The client service is then brought up to data with a snapshot.</p>
<h2 id="replicate-entire-file-using-sync-data">Replicate entire file using sync-data</h2>
<h4 id="server-code">Server code</h4>
<p>Register an application-level hook.
Its required for replicated remote services,
and will not affect ones not being replicated.</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">const</span> { client } = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;feathers-hooks-common&apos;</span>);

app.hooks({
  before: client(<span class="hljs-string">&apos;_offline&apos;</span>)
});
</code></pre>
<p>Configure the service that processes queued mutations on reconnection.</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">const</span> optimisticUpdatesRemote =
  <span class="hljs-built_in">require</span>(<span class="hljs-string">`feathers-mobilde-enterprise/lib/optimistic-updates/sync-data/remote`</span>);

app.configure(optimisticUpdatesRemote.service({ conflictResolver }));

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">conflictResolver</span>(<span class="hljs-params">{
  remoteService, uuid, lastMethod, clientDataCurrent, clientQuery, remoteDataCurrent,
  resolveUsingClient, resolveUsingServer, resolveManually
}</span>) </span>{
  <span class="hljs-keyword">return</span> resolveUsingClient(); <span class="hljs-comment">// always use client version of record</span>
}
</code></pre>
<h4 id="client-code">Client code</h4>
<p>Attach hooks to each replicated local service:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">const</span> { offlineFirstAfterHook, offlineFirstBeforeHook } = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;feathers-mobile&apos;</span>);
<span class="hljs-keyword">const</span> { client } = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;feathers-hooks-common&apos;</span>);

<span class="hljs-built_in">module</span>.exports = { <span class="hljs-comment">// &apos;client-service&apos;</span>
  before: {
    all: [
      client(<span class="hljs-string">&apos;_offline&apos;</span>),
      offlineFirstBeforeHook(<span class="hljs-string">&apos;foo&apos;</span>)
    ]
  },

  after: {
    all: offlineFirstAfterHook(<span class="hljs-string">&apos;foo&apos;</span>)
  }
};
</code></pre>
<p>Configure the replication and start it:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">const</span> commonPublications = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;feathers-mobile/lib/common/commonPublications&apos;</span>);
<span class="hljs-keyword">const</span> sync = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;feathers-mobile/lib/sync-data&apos;</span>);

<span class="hljs-keyword">const</span> replicator = sync({
  name: <span class="hljs-string">&apos;foo&apos;</span>,
  app: clientApp,
  remoteServiceName: <span class="hljs-string">&apos;remote-service&apos;</span>,
  clientServiceName: <span class="hljs-string">&apos;client-service&apos;</span>,
  eventQueueServiceName: <span class="hljs-string">&apos;client-service-queue&apos;</span> <span class="hljs-comment">// table to persist queue</span>
});

replicator.subscribe()
  .then(() =&gt; ...)
</code></pre>
<h4 id="example">Example</h4>
<p>You can run an example using this strategy.</p>
<pre><code class="lang-text">cd path/to/feathers-mobile/examples
npm install
cd ./sync-data
npm run build
npm start
</code></pre>
<p>Then point a browser at <code>localhost:3030</code>.</p>
<p>A snapshot of the remote service is made to the client when replication starts.</p>
<pre><code class="lang-text">===== remoteService, before mutations
{dept: &quot;a&quot;, stock: &quot;a1&quot;, uuid: &quot;aa1&quot;, _id: &quot;fbtKHSncfOqOie0l&quot;}
{dept: &quot;a&quot;, stock: &quot;a2&quot;, uuid: &quot;aa2&quot;, _id: &quot;QN9ugaxOlqwLRb4A&quot;}
{dept: &quot;a&quot;, stock: &quot;a3&quot;, uuid: &quot;aa3&quot;, _id: &quot;fcwE2SovnTACD45d&quot;}
{dept: &quot;a&quot;, stock: &quot;a4&quot;, uuid: &quot;aa4&quot;, _id: &quot;Eoi0lyr1GxWyAZoC&quot;}
{dept: &quot;a&quot;, stock: &quot;a5&quot;, uuid: &quot;aa5&quot;, _id: &quot;isoXUR6OpjjHQVQF&quot;}
===== clientService, before mutations
{dept: &quot;a&quot;, stock: &quot;a1&quot;, uuid: &quot;aa1&quot;, ___id: &quot;fbtKHSncfOqOie0l&quot;, _id: &quot;ixFV8jPcVmWFUESy&quot;}
{dept: &quot;a&quot;, stock: &quot;a2&quot;, uuid: &quot;aa2&quot;, ___id: &quot;QN9ugaxOlqwLRb4A&quot;, _id: &quot;FtgYKaU2ujbu9T7F&quot;}
{dept: &quot;a&quot;, stock: &quot;a3&quot;, uuid: &quot;aa3&quot;, ___id: &quot;fcwE2SovnTACD45d&quot;, _id: &quot;W4tHWgYht6AsPj4w&quot;}
{dept: &quot;a&quot;, stock: &quot;a4&quot;, uuid: &quot;aa4&quot;, ___id: &quot;Eoi0lyr1GxWyAZoC&quot;, _id: &quot;TCEYbaLq1d7yWUV2&quot;}
{dept: &quot;a&quot;, stock: &quot;a5&quot;, uuid: &quot;aa5&quot;, ___id: &quot;isoXUR6OpjjHQVQF&quot;, _id: &quot;ihS9go5yAsCbZ5fm&quot;}
</code></pre>
<p>We can simulate someone mutating the remote service,
while we mutate the client service.</p>
<pre><code class="lang-text">===== mutate remoteService
remoteService.patch stock: a1
remoteService.create stock: a99
remoteService.remove stock: a2
===== mutate clientService
clientService.patch stock: a1
clientService.create stock: a97
clientService.remove stock: a5
</code></pre>
<p>The remote and local services will both reflect the mutations.</p>
<pre><code class="lang-text">===== remoteService, after mutations
{dept: &quot;a&quot;, stock: &quot;a1&quot;, uuid: &quot;aa1&quot;, _id: &quot;fbtKHSncfOqOie0l&quot;, foo: 1&#x2026;}
{dept: &quot;a&quot;, stock: &quot;a3&quot;, uuid: &quot;aa3&quot;, _id: &quot;fcwE2SovnTACD45d&quot;}
{dept: &quot;a&quot;, stock: &quot;a4&quot;, uuid: &quot;aa4&quot;, _id: &quot;Eoi0lyr1GxWyAZoC&quot;}
{dept: &quot;a&quot;, stock: &quot;a97&quot;, uuid: &quot;aa97&quot;, _id: &quot;GqiM9KOwlKMUsV6p&quot;}
{dept: &quot;a&quot;, stock: &quot;a99&quot;, uuid: &quot;aa99&quot;, _id: &quot;6pIT67zaQwE73fuq&quot;}
===== clientService, after mutations
{dept: &quot;a&quot;, stock: &quot;a1&quot;, uuid: &quot;aa1&quot;, foo: 1, bar: 1&#x2026;}
{dept: &quot;a&quot;, stock: &quot;a3&quot;, uuid: &quot;aa3&quot;, ___id: &quot;fcwE2SovnTACD45d&quot;, _id: &quot;W4tHWgYht6AsPj4w&quot;}
{dept: &quot;a&quot;, stock: &quot;a4&quot;, uuid: &quot;aa4&quot;, ___id: &quot;Eoi0lyr1GxWyAZoC&quot;, _id: &quot;TCEYbaLq1d7yWUV2&quot;}
{dept: &quot;a&quot;, stock: &quot;a97&quot;, uuid: &quot;aa97&quot;, ___id: &quot;GqiM9KOwlKMUsV6p&quot;, _id: &quot;kLWR0BN4r6ZQYIJA&quot;}
{dept: &quot;a&quot;, stock: &quot;a99&quot;, uuid: &quot;aa99&quot;, ___id: &quot;6pIT67zaQwE73fuq&quot;, _id: &quot;XRTauC0tncI1DoRu&quot;}
</code></pre>
<p>We can simulate a lost connection, after which we mutate the client data,
while others mutate the remote service data.</p>
<pre><code class="lang-javascript">replicator.connection.disconnected();
</code></pre>
<pre><code class="lang-text">&gt;&gt;&gt;&gt;&gt; disconnection from server
===== mutations
clientService.patch stock: a3 bar: 1
clientService.patch stock: a3 bar: 2
clientService.patch stock: a97 bar: 1
remoteService.patch stock: a97 bux: 0
clientService.create stock: a98
clientService.patch stock: a98 bar 2
clientService.remove stock: a4
</code></pre>
<p><em>Notice that <code>stock: &quot;a97&quot;</code> has been changed, differently, on the client and on the server.</em></p>
<p>Now we simulate a reconnection.</p>
<pre><code class="lang-javascript">replicator.connection.reconnected();
</code></pre>
<pre><code class="lang-text">&lt;&lt;&lt;&lt;&lt; reconnected to server
</code></pre>
<p>The mutations that were queued on the client are sent to the server,
which updates the remote service while resolving any conflicts.
A summary of that processing is returned to the client.</p>
<pre><code class="lang-text">&lt;&lt;&lt;&lt;&lt; 0 errors on reconnect
&lt;&lt;&lt;&lt;&lt; entry 2 uuid:aa97 method:patch resolve-client
&lt;&lt;&lt;&lt;&lt; entry 4 uuid:aa98 method:patch resolve-client
</code></pre>
<p>The client service is then brought up to data with a snapshot.</p>
<pre><code class="lang-text">===== remoteService, after reconnection
{dept: &quot;a&quot;, stock: &quot;a1&quot;, uuid: &quot;aa1&quot;, _id: &quot;fbtKHSncfOqOie0l&quot;, foo: 1&#x2026;}
{dept: &quot;a&quot;, stock: &quot;a3&quot;, uuid: &quot;aa3&quot;, _id: &quot;fcwE2SovnTACD45d&quot;, bar: 2}
{dept: &quot;a&quot;, stock: &quot;a97&quot;, uuid: &quot;aa97&quot;, _id: &quot;GqiM9KOwlKMUsV6p&quot;, bux: 0&#x2026;}
{dept: &quot;a&quot;, stock: &quot;a98&quot;, uuid: &quot;aa98&quot;, _id: &quot;Kp5mGQHqg6UHn2L2&quot;, bar: 2}
{dept: &quot;a&quot;, stock: &quot;a99&quot;, uuid: &quot;aa99&quot;, _id: &quot;6pIT67zaQwE73fuq&quot;}
===== clientService, after reconnection
{dept: &quot;a&quot;, stock: &quot;a1&quot;, uuid: &quot;aa1&quot;, foo: 1, bar: 1&#x2026;}
{dept: &quot;a&quot;, stock: &quot;a3&quot;, uuid: &quot;aa3&quot;, bar: 2, ___id: &quot;fcwE2SovnTACD45d&quot;&#x2026;}
{dept: &quot;a&quot;, stock: &quot;a97&quot;, uuid: &quot;aa97&quot;, bux: 0, bar: 1&#x2026;}
{dept: &quot;a&quot;, stock: &quot;a98&quot;, uuid: &quot;aa98&quot;, bar: 2, ___id: &quot;Kp5mGQHqg6UHn2L2&quot;&#x2026;}
{dept: &quot;a&quot;, stock: &quot;a99&quot;, uuid: &quot;aa99&quot;, ___id: &quot;6pIT67zaQwE73fuq&quot;, _id: &quot;RfaOetDt53LY2YAG&quot;}
===== Example finished.
</code></pre>
<h2 id="replicate-entire-file-using-sync-net">Replicate entire file using sync-net</h2>
<p>The code for sync-net is almost identical to that for sync-data.
The only difference is that these modules are required instead:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">const</span> optimisticUpdatesRemote =
  <span class="hljs-built_in">require</span>(<span class="hljs-string">`feathers-mobilde-enterprise/lib/optimistic-updates/sync-net/remote`</span>);

<span class="hljs-keyword">const</span> sync = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;feathers-mobile/lib/sync-net&apos;</span>);
</code></pre>
<h4 id="example">Example</h4>
<p>You can run an example using this strategy.</p>
<pre><code class="lang-text">cd path/to/feathers-mobile/examples
npm install
cd ./sync-net
npm run build
npm start
</code></pre>
<p>Then point a browser at <code>localhost:3030</code>.</p>
<p>The log will be virtually identical.
The processing summary returned to the client will however be different.</p>
<pre><code class="lang-text">&lt;&lt;&lt;&lt;&lt; 0 errors on reconnect
&lt;&lt;&lt;&lt;&lt; entry 1 uuid:aa97 firstMethod:patch lastMethod:patch resolve-client
</code></pre>
<h2 id="replicating-with-publications-and-server-side-publications">Replicating with publications and server-side publications</h2>
<p>Some extra code has to be added.
Its the same as was added for the realtime strategy.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="realtime-setup.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page: realtime setup">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"sync-data, sync-net setup","level":"1.5.12","depth":2,"previous":{"title":"realtime setup","level":"1.5.11","depth":2,"path":"offline/realtime-setup.md","ref":"offline/realtime-setup.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["feathers-collapsible-menu","heading-anchors","include-codeblock"],"pluginsConfig":{"search":{},"lunr":{"maxIndexSize":1000000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"heading-anchors":{},"highlight":{},"include-codeblock":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"feathers-collapsible-menu":{}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css"}},"file":{"path":"offline/sync-setup.md","mtime":"2017-05-18T18:32:26.178Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2017-05-19T13:07:53.508Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-feathers-collapsible-menu/plugin.js"></script>
        
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/1.2.1/anchor.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-heading-anchors/anchor-style.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

